# üîç–ß—Ç–æ —Ç–∞–∫–æ–µ ABC –∞–Ω–∞–ª–∏–∑?
–≠—Ç–æ –º–µ—Ç–æ–¥, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –∑–∞–ø–∞—Å–∞–º–∏ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ –∏–ª–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∏—Ö –≤–∞–∂–Ω–æ—Å—Ç–∏ –∏ —Å—Ç–µ–ø–µ–Ω–∏ –≤–∫–ª–∞–¥–∞ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–æ–º–ø–∞–Ω–∏–∏.

**–ì—Ä—É–ø–ø–∞ –ê:** –≤–∞–∂–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤–Ω–æ—Å—è—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –≤–∫–ª–∞–¥ –≤ –¥–æ—Ö–æ–¥ –∏–ª–∏ —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç –±–æ–ª—å—à—É—é —á–∞—Å—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∑–∞–ø–∞—Å–æ–≤. –û–±—ã—á–Ω–æ –æ–Ω–∏ —Ç—Ä–µ–±—É—é—Ç —Ç—â–∞—Ç–µ–ª—å–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –∂–µ—Å—Ç–∫–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è. 

**–ì—Ä—É–ø–ø–∞ B:** —ç—Ç–æ —Ç–æ–≤–∞—Ä—ã —Å—Ä–µ–¥–Ω–µ–π –≤–∞–∂–Ω–æ—Å—Ç–∏. –û–Ω–∏ —Ç—Ä–µ–±—É—é—Ç —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.

**–ì—Ä—É–ø–ø–∞ –°:** —ç—Ç–∏ —Ç–æ–≤–∞—Ä—ã –æ–∫–∞–∑—ã–≤–∞—é—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –¥–æ—Ö–æ–¥ –∏–ª–∏ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–ø–∞—Å–æ–≤. –û–±—ã—á–Ω–æ –æ–Ω–∏ –∏–º–µ—é—Ç –±–æ–ª–µ–µ –Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è. –ß–∞—Å—Ç–æ —ç—Ç–æ –ø—Ä–µ—Ç–µ–Ω–¥–µ–Ω—Ç—ã –Ω–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –∏–∑ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞ –∏–ª–∏ –Ω–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã.

–û–ø—Ç–∏–º–∏–∑–∏—Ä—É—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∞—Å–∞–º–∏ –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤, –∞–Ω–∞–ª–∏–∑ ABC –ø–æ–º–æ–≥–∞–µ—Ç –∫–æ–º–ø–∞–Ω–∏—è–º –ø–æ–≤—ã—Å–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –±–æ–ª–µ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–∞—Ö. 

# üíæ–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

–¢–∞–±–ª–∏—Ü–∞ **list_of_orders**
 - order_id
 - order_date
 - customer_name
 - state
    
–¢–∞–±–ª–∏—Ü–∞ **order_details**
 - order_id
 - amount
 - profit
 - quantity
 - category
 - sub_category

# ‚úè–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
–î–ª—è –Ω–∞—á–∞–ª–∞ —Å–æ–µ–¥–∏–Ω–∏–º –¥–≤–µ —Ç–∞–±–ª–∏—ã—Ü –∏ —Å–æ–∑–¥–∞–¥–∏–º –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –æ–±—â–µ–π –ø—Ä–∏–±—ã–ª–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏.
```javascript
WITH profit_by_sub_category AS
(SELECT sub_category, SUM(profit) AS sub_category_profit
FROM 
list_of_orders
INNER JOIN order_details 
USING (order_id)
GROUP BY sub_category),
